<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>F√≥rmula M√©dica</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            background: #f5f5f5;
        }

        .hoja {
            max-width: 800px;
            margin: 0 auto;
            background: #ffffff;
            padding: 20px 30px;
            border: 1px solid #ddd;
        }

        .encabezado {
            display: flex;
            align-items: center;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .logo {
            width: 90px;
            height: 90px;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            margin-right: 15px;
            overflow: hidden;
        }

        .logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .datos-empresa {
            font-size: 12px;
            line-height: 1.4;
        }

        .titulo-formula {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0 20px;
            text-transform: uppercase;
        }

        .bloque {
            font-size: 13px;
            margin-bottom: 12px;
        }

        .bloque label {
            font-weight: bold;
        }

        .bloque span,
        .bloque input {
            display: inline-block;
            min-width: 120px;
        }

        .bloque input {
            border: none;
            border-bottom: 1px solid #000;
            padding: 2px 4px;
            font-size: 13px;
            width: 200px;
        }

        .receta {
            border: 1px solid #000;
            min-height: 200px;
            padding: 10px;
            font-size: 13px;
            white-space: pre-wrap;
        }

        .pie {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            font-size: 12px;
        }

        .firma {
            text-align: center;
            margin-top: 50px;
            font-size: 12px;
        }

        .firma-linea {
            border-top: 1px solid #000;
            width: 220px;
            margin: 0 auto 3px;
        }

        /* @media print {
            body {
                background: #ffffff;
                margin: 0;
            }

            .hoja {
                border: none;
                margin: 0;
                width: 100%;
                max-width: none;
            }
        } */
        @media print {
            body {
                margin: 0;
                background: #fff;
            }

            .hoja {
                width: 100%;
                max-width: none;
                margin: 0;
                border: none;
                box-shadow: none;
            }

            button,
            .no-print {
                display: none !important;
            }
        }
    </style>
    <script>
        window.addEventListener("message", (event) => {
            const datos = event.data;

            if (datos.nombrePaciente) {
                document.getElementById("campoNombrePaciente").value = datos.nombrePaciente;
            }

            if (datos.documentoPaciente) {
                document.getElementById("campoDocumentoPaciente").value = datos.documentoPaciente;
            }

            if (datos.edadPaciente) {
                document.getElementById("campoEdadPaciente").value = datos.edadPaciente;
            }

            // if (datos.fechaFormula) {
            //     document.getElementById("campoFechaFormula").value = datos.fechaFormula;
            // }

        });

        function Toggle() {
            document.getElementById("campoFechaFormula").value = new Date().toLocaleDateString();
        }
    </script>

</head>

<body onload="Toggle()">
    <div class="hoja">
        <!-- ENCABEZADO -->
        <header class="encabezado">
            <div class="logo">
                <!-- Reemplaza src con la ruta de tu logo, por ejemplo: logo.png -->
                <img src="../IMG/Logo_Ceere.jpg" alt="Logo">

            </div>
            <div class="datos-empresa">
                <strong>Nombre del Profesional / IPS</strong><br />
                Especialidad m√©dica<br />
                Registro M√©dico: XXXX<br />
                Direcci√≥n: Calle 00 # 00 - 00, Ciudad<br />
                Tel√©fono: (000) 000 00 00<br />
                Correo: correo@ejemplo.com
            </div>
        </header>

        <!-- T√çTULO -->
        <div class="titulo-formula">F√≥rmula M√©dica</div>

        <!-- DATOS DEL PACIENTE -->
        <section class="bloque">
            <label>Paciente:</label>
            <input type="text" id="campoNombrePaciente" />
            <label>Edad:</label>
            <input type="text" id="campoEdadPaciente" style="width: 60px;" />
        </section>

        <section class="bloque">
            <label>Documento:</label>
            <input type="text" id="campoDocumentoPaciente" />
            <label>Fecha:</label>
            <input type="text" id="campoFechaFormula" placeholder="dd/mm/aaaa" />
        </section>

        <!-- CONTENIDO DE LA F√ìRMULA -->
        <section class="bloque">
            <label>Prescripci√≥n:</label>
            <div class="receta" id="ContenidoFormula" contenteditable="true">
                <!-- Aqu√≠ se agregar√°n los medicamentos -->
            </div>
        </section>


        <!-- PIE DE P√ÅGINA -->
        <!-- <div class="pie">
            <div>
                <strong>Diagn√≥stico(s):</strong> ________________________________
            </div>
            <div>
                <strong>No. Historia:</strong> ________________________________
            </div>
        </div> -->

        <!-- FIRMA -->
        <div class="firma">
            <div class="firma-linea"></div>
            Dr(a). Nombre del M√©dico<br />
            Registro M√©dico: XXXX
        </div>
    </div>
    <script>
        window.addEventListener('message', function (event) {
            const data = event.data || {};

            // üëâ aqu√≠ podr√≠as tambi√©n manejar los datos del paciente, si ya los env√≠as
            if (data.tipo === 'agregarMedicamento' && data.linea) {
                const recetaDiv = document.getElementById('ContenidoFormula');
                if (!recetaDiv) return;

                // Tomamos el contenido actual
                const actual = recetaDiv.innerHTML.trim();

                // Si ya hay algo, agregamos un <br> y luego la nueva l√≠nea.
                // Si no hay nada, simplemente ponemos la l√≠nea.
                if (actual) {
                    recetaDiv.innerHTML = actual + '<br>' + data.linea;
                } else {
                    recetaDiv.innerHTML = data.linea;
                }
            }
        });
    </script>

</body>

</html>